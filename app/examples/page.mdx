# Examples

Explore practical examples and use cases for the Next.js Enterprise Starter Kit. These examples demonstrate real-world implementations of the core features.

## Authentication Examples

### Custom Login Form

```typescript
// components/auth/LoginForm.tsx
import { useState } from 'react';
import { useRouter } from 'next/navigation';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { z } from 'zod';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { useAuth } from '@/hooks/useAuth';

const loginSchema = z.object({
  email: z.string().email('Invalid email address'),
  password: z.string().min(8, 'Password must be at least 8 characters'),
});

type LoginFormData = z.infer<typeof loginSchema>;

export function LoginForm() {
  const [isLoading, setIsLoading] = useState(false);
  const { login } = useAuth();
  const router = useRouter();

  const {
    register,
    handleSubmit,
    formState: { errors },
    setError,
  } = useForm<LoginFormData>({
    resolver: zodResolver(loginSchema),
  });

  const onSubmit = async (data: LoginFormData) => {
    setIsLoading(true);
    try {
      await login(data);
      router.push('/dashboard');
    } catch (error) {
      setError('root', {
        message: 'Invalid email or password',
      });
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <form onSubmit={handleSubmit(onSubmit)} className="space-y-4">
      <div>
        <Input
          {...register('email')}
          type="email"
          placeholder="Email"
          error={errors.email?.message}
        />
      </div>
      <div>
        <Input
          {...register('password')}
          type="password"
          placeholder="Password"
          error={errors.password?.message}
        />
      </div>
      {errors.root && (
        <p className="text-sm text-red-600">{errors.root.message}</p>
      )}
      <Button type="submit" className="w-full" disabled={isLoading}>
        {isLoading ? 'Signing in...' : 'Sign in'}
      </Button>
    </form>
  );
}
```

### Protected Route Component

```typescript
// components/auth/ProtectedRoute.tsx
import { useEffect } from 'react';
import { useRouter } from 'next/navigation';
import { useAuth } from '@/hooks/useAuth';
import { LoadingSpinner } from '@/components/ui/loading-spinner';

interface ProtectedRouteProps {
  children: React.ReactNode;
  requiredRole?: 'admin' | 'user' | 'moderator';
  fallback?: React.ReactNode;
}

export function ProtectedRoute({ 
  children, 
  requiredRole,
  fallback 
}: ProtectedRouteProps) {
  const { user, isLoading } = useAuth();
  const router = useRouter();

  useEffect(() => {
    if (!isLoading && !user) {
      router.push('/auth/login');
    }
  }, [user, isLoading, router]);

  if (isLoading) {
    return <LoadingSpinner />;
  }

  if (!user) {
    return fallback || null;
  }

  if (requiredRole && user.role !== requiredRole) {
    return (
      <div className="text-center py-8">
        <h2 className="text-2xl font-bold text-gray-900">Access Denied</h2>
        <p className="text-gray-600">You don't have permission to view this page.</p>
      </div>
    );
  }

  return <>{children}</>;
}
```

## Form Examples

### Dynamic Form Builder

```typescript
// components/forms/DynamicForm.tsx
import { BaseForm } from '@/components/forms/BaseForm';
import { z } from 'zod';

// Define form schema
const userProfileSchema = z.object({
  personalInfo: z.object({
    firstName: z.string().min(2, 'First name is required'),
    lastName: z.string().min(2, 'Last name is required'),
    email: z.string().email('Invalid email'),
    phone: z.string().optional(),
  }),
  preferences: z.object({
    theme: z.enum(['light', 'dark', 'system']),
    notifications: z.boolean(),
    newsletter: z.boolean(),
  }),
  address: z.object({
    street: z.string(),
    city: z.string(),
    country: z.string(),
    zipCode: z.string(),
  }).optional(),
});

// Define form fields
const formFields = [
  {
    name: 'personalInfo.firstName',
    type: 'text',
    label: 'First Name',
    required: true,
    grid: { col: 6 },
  },
  {
    name: 'personalInfo.lastName',
    type: 'text',
    label: 'Last Name',
    required: true,
    grid: { col: 6 },
  },
  {
    name: 'personalInfo.email',
    type: 'email',
    label: 'Email Address',
    required: true,
    grid: { col: 12 },
  },
  {
    name: 'personalInfo.phone',
    type: 'text',
    label: 'Phone Number',
    grid: { col: 6 },
  },
  {
    name: 'preferences.theme',
    type: 'select',
    label: 'Theme Preference',
    options: [
      { value: 'light', label: 'Light' },
      { value: 'dark', label: 'Dark' },
      { value: 'system', label: 'System' },
    ],
    grid: { col: 6 },
  },
  {
    name: 'preferences.notifications',
    type: 'checkbox',
    label: 'Enable Notifications',
    grid: { col: 6 },
  },
  {
    name: 'preferences.newsletter',
    type: 'checkbox',
    label: 'Subscribe to Newsletter',
    grid: { col: 6 },
  },
];

// Define form sections
const formSections = [
  {
    title: 'Personal Information',
    description: 'Basic information about yourself',
    fields: ['personalInfo.firstName', 'personalInfo.lastName', 'personalInfo.email', 'personalInfo.phone'],
  },
  {
    title: 'Preferences',
    description: 'Customize your experience',
    fields: ['preferences.theme', 'preferences.notifications', 'preferences.newsletter'],
  },
  {
    title: 'Address (Optional)',
    description: 'Your address information',
    fields: ['address.street', 'address.city', 'address.country', 'address.zipCode'],
    collapsible: true,
    defaultCollapsed: true,
  },
];

export function UserProfileForm() {
  const handleSubmit = async (data: z.infer<typeof userProfileSchema>) => {
    try {
      await userAPI.updateProfile(data);
      toast.success('Profile updated successfully');
    } catch (error) {
      toast.error('Failed to update profile');
    }
  };

  return (
    <BaseForm
      schema={userProfileSchema}
      fields={formFields}
      sections={formSections}
      onSubmit={handleSubmit}
      layout="grid"
      submitText="Update Profile"
    />
  );
}
```

### Conditional Form Fields

```typescript
// components/forms/ConditionalForm.tsx
import { useWatch } from 'react-hook-form';
import { BaseForm } from '@/components/forms/BaseForm';

const orderSchema = z.object({
  orderType: z.enum(['pickup', 'delivery']),
  customerInfo: z.object({
    name: z.string().min(2),
    phone: z.string().min(10),
  }),
  deliveryAddress: z.object({
    street: z.string(),
    city: z.string(),
    zipCode: z.string(),
  }).optional(),
  specialInstructions: z.string().optional(),
});

export function OrderForm() {
  const orderType = useWatch({ name: 'orderType' });

  const formFields = [
    {
      name: 'orderType',
      type: 'radio',
      label: 'Order Type',
      options: [
        { value: 'pickup', label: 'Pickup' },
        { value: 'delivery', label: 'Delivery' },
      ],
      required: true,
    },
    {
      name: 'customerInfo.name',
      type: 'text',
      label: 'Customer Name',
      required: true,
    },
    {
      name: 'customerInfo.phone',
      type: 'text',
      label: 'Phone Number',
      required: true,
    },
    // Conditional delivery fields
    ...(orderType === 'delivery' ? [
      {
        name: 'deliveryAddress.street',
        type: 'text',
        label: 'Street Address',
        required: true,
      },
      {
        name: 'deliveryAddress.city',
        type: 'text',
        label: 'City',
        required: true,
      },
      {
        name: 'deliveryAddress.zipCode',
        type: 'text',
        label: 'ZIP Code',
        required: true,
      },
    ] : []),
    {
      name: 'specialInstructions',
      type: 'textarea',
      label: 'Special Instructions',
      placeholder: 'Any special requests or instructions...',
    },
  ];

  return (
    <BaseForm
      schema={orderSchema}
      fields={formFields}
      onSubmit={handleOrderSubmit}
    />
  );
}
```

## Dashboard Examples

### Real-time Metrics Dashboard

```typescript
// components/dashboard/MetricsDashboard.tsx
import { useQuery } from '@tanstack/react-query';
import { useSocket } from '@/hooks/useSocket';
import { MetricCard } from '@/components/dashboard/MetricCard';
import { Chart } from '@/components/dashboard/Chart';

interface DashboardMetrics {
  totalUsers: number;
  activeUsers: number;
  revenue: number;
  conversionRate: number;
  chartData: Array<{
    date: string;
    users: number;
    revenue: number;
  }>;
}

export function MetricsDashboard() {
  const { data: metrics, refetch } = useQuery({
    queryKey: ['dashboard', 'metrics'],
    queryFn: () => dashboardAPI.getMetrics(),
    refetchInterval: 30000, // Refetch every 30 seconds
  });

  // Real-time updates via Socket.IO
  useSocket('metrics:update', (updatedMetrics: DashboardMetrics) => {
    queryClient.setQueryData(['dashboard', 'metrics'], updatedMetrics);
  });

  if (!metrics) {
    return <DashboardSkeleton />;
  }

  return (
    <div className="space-y-6">
      {/* Metrics Cards */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <MetricCard
          title="Total Users"
          value={metrics.totalUsers}
          change={12.5}
          changeType="increase"
          icon={Users}
        />
        <MetricCard
          title="Active Users"
          value={metrics.activeUsers}
          change={8.2}
          changeType="increase"
          icon={UserCheck}
        />
        <MetricCard
          title="Revenue"
          value={metrics.revenue}
          format="currency"
          change={15.3}
          changeType="increase"
          icon={DollarSign}
        />
        <MetricCard
          title="Conversion Rate"
          value={metrics.conversionRate}
          format="percentage"
          change={-2.1}
          changeType="decrease"
          icon={TrendingUp}
        />
      </div>

      {/* Charts */}
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <Chart
          title="User Growth"
          type="line"
          data={metrics.chartData}
          xAxis="date"
          yAxis="users"
          height={300}
        />
        <Chart
          title="Revenue Trend"
          type="area"
          data={metrics.chartData}
          xAxis="date"
          yAxis="revenue"
          height={300}
        />
      </div>
    </div>
  );
}
```

### Data Table with Actions

```typescript
// components/dashboard/UsersTable.tsx
import { useState } from 'react';
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { DataTable } from '@/components/ui/data-table';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { MoreHorizontal, Edit, Trash2, UserX } from 'lucide-react';

interface User {
  id: string;
  name: string;
  email: string;
  role: 'admin' | 'user' | 'moderator';
  status: 'active' | 'inactive' | 'suspended';
  createdAt: string;
}

export function UsersTable() {
  const [pagination, setPagination] = useState({ page: 0, size: 10 });
  const [sorting, setSorting] = useState([]);
  const [filtering, setFiltering] = useState('');

  const queryClient = useQueryClient();

  const { data: users, isLoading } = useQuery({
    queryKey: ['users', pagination, sorting, filtering],
    queryFn: () => userAPI.getUsers({
      page: pagination.page,
      size: pagination.size,
      sort: sorting,
      filter: filtering,
    }),
  });

  const deleteUserMutation = useMutation({
    mutationFn: userAPI.delete,
    onSuccess: () => {
      queryClient.invalidateQueries(['users']);
      toast.success('User deleted successfully');
    },
  });

  const suspendUserMutation = useMutation({
    mutationFn: userAPI.suspend,
    onSuccess: () => {
      queryClient.invalidateQueries(['users']);
      toast.success('User suspended successfully');
    },
  });

  const columns = [
    {
      accessorKey: 'name',
      header: 'Name',
    },
    {
      accessorKey: 'email',
      header: 'Email',
    },
    {
      accessorKey: 'role',
      header: 'Role',
      cell: ({ row }) => (
        <Badge variant={row.original.role === 'admin' ? 'default' : 'secondary'}>
          {row.original.role}
        </Badge>
      ),
    },
    {
      accessorKey: 'status',
      header: 'Status',
      cell: ({ row }) => (
        <Badge 
          variant={
            row.original.status === 'active' ? 'success' :
            row.original.status === 'inactive' ? 'secondary' : 'destructive'
          }
        >
          {row.original.status}
        </Badge>
      ),
    },
    {
      accessorKey: 'createdAt',
      header: 'Created',
      cell: ({ row }) => new Date(row.original.createdAt).toLocaleDateString(),
    },
    {
      id: 'actions',
      header: 'Actions',
      cell: ({ row }) => (
        <DropdownMenu>
          <DropdownMenuTrigger asChild>
            <Button variant="ghost" size="sm">
              <MoreHorizontal className="h-4 w-4" />
            </Button>
          </DropdownMenuTrigger>
          <DropdownMenuContent align="end">
            <DropdownMenuItem onClick={() => handleEdit(row.original)}>
              <Edit className="h-4 w-4 mr-2" />
              Edit
            </DropdownMenuItem>
            <DropdownMenuItem 
              onClick={() => suspendUserMutation.mutate(row.original.id)}
            >
              <UserX className="h-4 w-4 mr-2" />
              Suspend
            </DropdownMenuItem>
            <DropdownMenuSeparator />
            <DropdownMenuItem 
              onClick={() => deleteUserMutation.mutate(row.original.id)}
              className="text-red-600"
            >
              <Trash2 className="h-4 w-4 mr-2" />
              Delete
            </DropdownMenuItem>
          </DropdownMenuContent>
        </DropdownMenu>
      ),
    },
  ];

  return (
    <DataTable
      data={users?.data || []}
      columns={columns}
      pagination={{
        pageIndex: pagination.page,
        pageSize: pagination.size,
        pageCount: users?.totalPages || 0,
        onPaginationChange: setPagination,
      }}
      sorting={{
        sorting,
        onSortingChange: setSorting,
      }}
      filtering={{
        globalFilter: filtering,
        onGlobalFilterChange: setFiltering,
      }}
      loading={isLoading}
    />
  );
}
```

## Layout Examples

### Custom Layout Implementation

```typescript
// components/layouts/CustomLayout.tsx
import { useState, useEffect } from 'react';
import { useLayout } from '@/hooks/useLayout';
import { Header } from '@/components/layout/Header';
import { Sidebar } from '@/components/layout/Sidebar';
import { Footer } from '@/components/layout/Footer';

interface CustomLayoutProps {
  children: React.ReactNode;
  preset?: 'dashboard' | 'portal' | 'website';
}

export function CustomLayout({ children, preset = 'dashboard' }: CustomLayoutProps) {
  const { layout, updateLayout } = useLayout();
  const [sidebarOpen, setSidebarOpen] = useState(false);

  useEffect(() => {
    // Apply preset configuration
    const presetConfig = getPresetConfig(preset);
    updateLayout(presetConfig);
  }, [preset, updateLayout]);

  return (
    <div className="min-h-screen bg-background">
      {layout.header.enabled && (
        <Header
          fixed={layout.header.fixed}
          height={layout.header.height}
          onMenuClick={() => setSidebarOpen(!sidebarOpen)}
        />
      )}
      
      <div className="flex">
        {layout.sidebar.enabled && (
          <Sidebar
            open={sidebarOpen}
            onClose={() => setSidebarOpen(false)}
            variant={layout.sidebar.variant}
            width={layout.sidebar.width}
            collapsible={layout.sidebar.collapsible}
          />
        )}
        
        <main 
          className={cn(
            'flex-1 transition-all duration-300',
            layout.header.enabled && layout.header.fixed && 'pt-16',
            layout.sidebar.enabled && layout.sidebar.variant === 'fixed' && 'ml-64'
          )}
        >
          <div className={cn(
            'container mx-auto',
            layout.content.padding === 'sm' && 'p-4',
            layout.content.padding === 'md' && 'p-6',
            layout.content.padding === 'lg' && 'p-8'
          )}>
            {children}
          </div>
        </main>
      </div>
      
      {layout.footer.enabled && (
        <Footer
          fixed={layout.footer.fixed}
          showLinks={layout.footer.showLinks}
        />
      )}
    </div>
  );
}

function getPresetConfig(preset: string) {
  const presets = {
    dashboard: {
      header: { enabled: true, fixed: true },
      sidebar: { enabled: true, variant: 'fixed' },
      footer: { enabled: false },
      content: { padding: 'md' },
    },
    portal: {
      header: { enabled: true, fixed: false },
      sidebar: { enabled: true, variant: 'drawer' },
      footer: { enabled: true },
      content: { padding: 'lg' },
    },
    website: {
      header: { enabled: true, fixed: false },
      sidebar: { enabled: false },
      footer: { enabled: true },
      content: { padding: 'lg' },
    },
  };
  
  return presets[preset] || presets.dashboard;
}
```

## Real-time Examples

### Chat Component with Socket.IO

```typescript
// components/chat/ChatRoom.tsx
import { useState, useEffect, useRef } from 'react';
import { useSocket } from '@/hooks/useSocket';
import { useAuth } from '@/hooks/useAuth';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { ScrollArea } from '@/components/ui/scroll-area';

interface Message {
  id: string;
  userId: string;
  username: string;
  content: string;
  timestamp: string;
}

export function ChatRoom({ roomId }: { roomId: string }) {
  const [messages, setMessages] = useState<Message[]>([]);
  const [newMessage, setNewMessage] = useState('');
  const [isTyping, setIsTyping] = useState(false);
  const [typingUsers, setTypingUsers] = useState<string[]>([]);
  const messagesEndRef = useRef<HTMLDivElement>(null);
  const { user } = useAuth();
  const socket = useSocket();

  useEffect(() => {
    if (!socket) return;

    // Join room
    socket.emit('join-room', roomId);

    // Listen for messages
    socket.on('message', (message: Message) => {
      setMessages(prev => [...prev, message]);
    });

    // Listen for typing indicators
    socket.on('user-typing', (username: string) => {
      setTypingUsers(prev => [...prev.filter(u => u !== username), username]);
    });

    socket.on('user-stopped-typing', (username: string) => {
      setTypingUsers(prev => prev.filter(u => u !== username));
    });

    return () => {
      socket.off('message');
      socket.off('user-typing');
      socket.off('user-stopped-typing');
      socket.emit('leave-room', roomId);
    };
  }, [socket, roomId]);

  useEffect(() => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  }, [messages]);

  const sendMessage = () => {
    if (!newMessage.trim() || !socket) return;

    const message = {
      roomId,
      content: newMessage,
      userId: user?.id,
      username: user?.name,
    };

    socket.emit('send-message', message);
    setNewMessage('');
    handleStopTyping();
  };

  const handleTyping = () => {
    if (!isTyping && socket) {
      setIsTyping(true);
      socket.emit('typing', { roomId, username: user?.name });
    }
  };

  const handleStopTyping = () => {
    if (isTyping && socket) {
      setIsTyping(false);
      socket.emit('stop-typing', { roomId, username: user?.name });
    }
  };

  return (
    <div className="flex flex-col h-96 border rounded-lg">
      <ScrollArea className="flex-1 p-4">
        {messages.map((message) => (
          <div
            key={message.id}
            className={cn(
              'mb-2 p-2 rounded',
              message.userId === user?.id
                ? 'bg-blue-100 ml-auto max-w-xs'
                : 'bg-gray-100 mr-auto max-w-xs'
            )}
          >
            <div className="text-xs text-gray-500 mb-1">
              {message.username} â€¢ {new Date(message.timestamp).toLocaleTimeString()}
            </div>
            <div>{message.content}</div>
          </div>
        ))}
        {typingUsers.length > 0 && (
          <div className="text-sm text-gray-500 italic">
            {typingUsers.join(', ')} {typingUsers.length === 1 ? 'is' : 'are'} typing...
          </div>
        )}
        <div ref={messagesEndRef} />
      </ScrollArea>
      
      <div className="p-4 border-t flex gap-2">
        <Input
          value={newMessage}
          onChange={(e) => {
            setNewMessage(e.target.value);
            handleTyping();
          }}
          onKeyPress={(e) => e.key === 'Enter' && sendMessage()}
          onBlur={handleStopTyping}
          placeholder="Type a message..."
          className="flex-1"
        />
        <Button onClick={sendMessage} disabled={!newMessage.trim()}>
          Send
        </Button>
      </div>
    </div>
  );
}
```

These examples demonstrate practical implementations of the core features in the Next.js Enterprise Starter Kit. Use them as starting points for your own applications and customize them according to your specific requirements.